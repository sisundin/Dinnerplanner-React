{"ast":null,"code":"import _toConsumableArray from\"/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import{ENDPOINT,API_KEY}from\"./apiConfig\";var DinnerModel=/*#__PURE__*/function(_React$Component){_inherits(DinnerModel,_React$Component);function DinnerModel(){var _this;var guests=arguments.length>0&&arguments[0]!==undefined?arguments[0]:2;var dishes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,DinnerModel);_this=_possibleConstructorReturn(this,_getPrototypeOf(DinnerModel).call(this));_this.numberOfGuests=guests;_this.subscribers=[];_this.dishes=dishes;return _this;}_createClass(DinnerModel,[{key:\"setNumberOfGuests\",value:function setNumberOfGuests(x){this.numberOfGuests=x;this.notifyObservers();// TODO\n}},{key:\"getNumberOfGuests\",value:function getNumberOfGuests(){return this.numberOfGuests;// TODO\n}},{key:\"addObserver\",value:function addObserver(callback){this.subscribers.push(callback);}},{key:\"removeObserver\",value:function removeObserver(callback){callback=this.subscribers.filter(function(o){return o!==callback;});}},{key:\"notifyObservers\",value:function notifyObservers(whatHappened){this.subscribers.forEach(function(callback){callback(whatHappened);});}},{key:\"dishInMenu\",value:function dishInMenu(dish){var array=this.dishes.filter(function(di){return di.id===dish.id;});if(array.length<1||array===undefined){return true;}return false;}},{key:\"getDishPrice\",value:function getDishPrice(dish){this.dishprice=this.sum(dish.extendedIngredients)*this.getNumberOfGuests();return this.dishprice;}},{key:\"sum\",value:function sum(input){if(toString.call(input)!==\"[object Array]\")return false;var total=0;for(var i=0;i<input.length;i++){if(isNaN(input[i].amount)){continue;}total+=Number(input[i].amount);}return total;}},{key:\"addToMenu\",value:function addToMenu(dish){var uniqify=function uniqify(array,key){return array.reduce(function(prev,curr){return prev.find(function(a){return a[key]===curr[key];})?prev:prev.push(curr)&&prev;},[]);};this.dishes=[].concat(_toConsumableArray(this.dishes),[dish]);this.dishes=uniqify(this.dishes,'id');this.notifyObservers({add_dish:dish});}},{key:\"getApiData\",value:function getApiData(string){var _this2=this;return fetch(ENDPOINT+string,{\"method\":\"GET\",\"headers\":{'X-Mashape-Key':API_KEY}}).then(function(response){return _this2.handleHTTPError(response);}).then(function(response){return response.json();}).catch(function(error){return console.log(error);});}},{key:\"searchDishes\",value:function searchDishes(){var dishType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";var freeText=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"\";return this.getApiData(\"recipes/search?type=\"+dishType+\"&query=\"+freeText).then(function(data){return data.results;});// from headers to response data   \n}},{key:\"handleHTTPError\",value:function handleHTTPError(response){if(response.ok)return response;throw Error(response.statusText);}},{key:\"getDishDetails\",value:function getDishDetails(){var id=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"837136\";return this.getApiData(\"recipes/\"+id+\"/information\");}},{key:\"getMenu\",value:function getMenu(){return _toConsumableArray(this.dishes);}},{key:\"removeFromMenu\",value:function removeFromMenu(dishid){this.dishes=this.dishes.filter(function(dish){return dish.id!==dishid;});this.notifyObservers({removed:dishid});}},{key:\"getShoppingList\",value:function getShoppingList(){var _this3=this;this.shoppingListObj=[];this.getMenu().forEach(function(dish){return dish.extendedIngredients.forEach(function(ingredient){if(_this3.shoppingListObj.find(function(listobject){return listobject.name===ingredient.name;})){_this3.shoppingListObj.forEach(function(dubble){if(dubble.name===ingredient.name){dubble.amount+=ingredient.amount;}});}else{_this3.shoppingListObj.push({name:ingredient.name,aisle:ingredient.aisle,amount:ingredient.amount});}});});var x=this.shoppingListObj.sort(function(a,b){if(a.aisle<b.aisle){return-1;}if(a.aisle>b.aisle){return 1;}else{return 0;}});x=x.sort(function(a,b){if(a.aisle===b.aisle&&a.name<b.name){return-1;}if(a.aisle===b.aisle&&a.name<b.name){return 1;}else{return 0;}});return x;}}]);return DinnerModel;}(React.Component);var dinnerModel=new DinnerModel();export default dinnerModel;","map":{"version":3,"sources":["/Users/simonsundin/Desktop/KTH/Interaktions_design/tutorialweek4/dinnerplanner/src/dinnerstuff/DinnerModel.js"],"names":["React","ENDPOINT","API_KEY","DinnerModel","guests","dishes","numberOfGuests","subscribers","x","notifyObservers","callback","push","filter","o","whatHappened","forEach","dish","array","di","id","length","undefined","dishprice","sum","extendedIngredients","getNumberOfGuests","input","toString","call","total","i","isNaN","amount","Number","uniqify","key","reduce","prev","curr","find","a","add_dish","string","fetch","then","response","handleHTTPError","json","catch","error","console","log","dishType","freeText","getApiData","data","results","ok","Error","statusText","dishid","removed","shoppingListObj","getMenu","ingredient","listobject","name","dubble","aisle","sort","b","Component","dinnerModel"],"mappings":"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","sourcesContent":["import React  from \"react\";\nimport {ENDPOINT, API_KEY} from \"./apiConfig\"\n\nclass DinnerModel extends React.Component{\n    constructor(guests=2, dishes=[]){\n        super();\n        this.numberOfGuests=guests;\n        this.subscribers=[];\n        this.dishes=dishes;\n    \n        }\n        \n    \n    setNumberOfGuests(x){\n        this.numberOfGuests=x; \n        this.notifyObservers() // TODO\n\n    }\n    getNumberOfGuests(){\n        return this.numberOfGuests; // TODO\n    }\n\n    \n    addObserver(callback){\n        this.subscribers.push(callback);\n }\n\n    removeObserver (callback) {\n    callback = this.subscribers.filter(o => o !== callback);\n    };\n   \n    notifyObservers(whatHappened){\n        this.subscribers.forEach(function(callback){ \n            callback(whatHappened);\n       });\n    }\n     \n    dishInMenu(dish){\n        let array = this.dishes.filter(function(di){ return di.id === dish.id });\n        if(array.length < 1 || array === undefined){\n            return true;\n        }\n        return false;\n    }  \n\n    getDishPrice(dish){\n        this.dishprice = this.sum(dish.extendedIngredients) * this.getNumberOfGuests();\n        return this.dishprice;\n    }\n\n    sum(input){\n             \n        if (toString.call(input) !== \"[object Array]\")\n           return false;\n             \n                   var total =  0;\n                   for(var i=0;i<input.length;i++)\n                     {                  \n                       if(isNaN(input[i].amount)){\n                       continue;\n                        }\n                         total += Number(input[i].amount);\n                      }\n                    return total;\n                   }\n  \n\n    addToMenu(dish){\n        const uniqify = (array, key) => array.reduce((prev, curr) => \n        prev.find(a => a[key] === curr[key]) ? prev : prev.push(curr) && prev, []);\n        this.dishes=[...this.dishes, dish];\n        this.dishes = uniqify(this.dishes, 'id')\n        this.notifyObservers({\n            add_dish: dish\n        })\n    }\n    \n\n    getApiData(string) {\n        return fetch ( ENDPOINT+string, {\n            \"method\": \"GET\",\n            \"headers\": {\n            'X-Mashape-Key' : API_KEY\n        } ,               \n\n    }).then(response => this.handleHTTPError(response))\n        .then(response => response.json())\n        .catch(error => console.log(error));\n         \n    }\n    \n\n    searchDishes(dishType=\"\", freeText=\"\") {\n    \n        return this.getApiData(\"recipes/search?type=\"+dishType+\"&query=\"+freeText).then(data=>data.results)   // from headers to response data   \n        \n    }\n    handleHTTPError(response) {\n        if(response.ok)\n           return response;\n        throw Error(response.statusText);\n      }\n\n    getDishDetails(id=\"837136\"){\n        return this.getApiData(\"recipes/\"+id+\"/information\")\n    }\n\n    getMenu(){\n        return [...this.dishes]\n    }\n\n    removeFromMenu(dishid){\n        this.dishes = this.dishes.filter(dish => dish.id !== dishid);\n        this.notifyObservers({removed:dishid});\n\n    \n    }\n\n    getShoppingList(){\n        this.shoppingListObj= []\n        this.getMenu().forEach(dish => \n        dish.extendedIngredients.forEach(ingredient => {\n        if (this.shoppingListObj.find(listobject => listobject.name === ingredient.name)){\n            this.shoppingListObj.forEach( dubble => {                   \n                 if (dubble.name === ingredient.name) {\n                        dubble.amount += ingredient.amount;\n                    }\n            })\n                \n            }\n        else {\n            this.shoppingListObj.push({name: ingredient.name , aisle: ingredient.aisle , amount: ingredient.amount});\n            }\n        }));\n        let x = this.shoppingListObj.sort(function(a,b) \n        {if (a.aisle < b.aisle){return -1;}\n        if (a.aisle > b.aisle){return 1;}\n        else {return 0;}\n        });\n        x = x.sort(function(a,b) \n        {if (a.aisle === b.aisle && a.name < b.name){return -1;}\n        if (a.aisle === b.aisle && a.name < b.name) {return 1;}\n        else {return 0;} \n        });\n        return x;\n        }\n      \n        \n       \n    \n}\n\n\nconst dinnerModel = new DinnerModel();\nexport default dinnerModel;"]},"metadata":{},"sourceType":"module"}